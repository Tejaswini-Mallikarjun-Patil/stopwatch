<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Stopwatch</title>
  <style>
    :root {
      --bg: #0b1220;
      --panel: #111a2b;
      --text: #e8f0ff;
      --muted: #96a3bf;
      --accent: #6aa6ff;
      --accent-2: #4de4c2;
      --danger: #ff6b6b;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
    }
    [data-theme="light"] {
      --bg: #f9fbff;
      --panel: #ffffff;
      --text: #1c1c1c;
      --muted: #666;
      --accent: #2b78e4;
      --accent-2: #0bbd87;
      --danger: #d93025;
      --shadow: 0 6px 18px rgba(0,0,0,.15);
    }
    * { box-sizing:border-box }
    html,body { height:100% }
    body {
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell;
      background: var(--bg);
      color:var(--text); display:grid; place-items:center; padding:20px;
      transition: background .3s, color .3s;
    }
    .app { width:min(920px, 95vw); }
    .card {
      background: var(--panel);
      backdrop-filter: blur(10px);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:24px;
      border:1px solid rgba(255,255,255,.06);
      transition: background .3s;
    }
    header {
      display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:18px;
    }
    h1 { font-size:clamp(20px, 4vw, 28px); margin:0 }
    .hint { color:var(--muted); font-size:14px }
    .theme-toggle { cursor:pointer; font-size:18px; background:none; border:none; color:var(--text); }

    .timer {
      display:flex; align-items:baseline; justify-content:center; gap:8px; 
      font-variant-numeric: tabular-nums; user-select:none;
      padding:10px 0 6px;
    }
    .time { font-size: clamp(40px, 10vw, 88px); font-weight:700 }
    .millis { font-size: clamp(18px, 4vw, 28px); opacity:.8; min-width:2ch }

    .controls {
      display:flex; flex-wrap:wrap; gap:12px; justify-content:center; margin:18px 0 6px;
    }
    button {
      appearance:none; border:none; border-radius: 999px; padding:12px 18px; 
      background:#1a2742; color:var(--text); cursor:pointer; font-size:15px;
      transition: transform .06s, background .2s, box-shadow .2s;
    }
    button:hover { transform: translateY(-1px); }
    button:active { transform: translateY(1px) scale(.99); }
    button:disabled { opacity:.4; cursor:not-allowed; }
    .primary { background: linear-gradient(135deg, var(--accent), #7ad7ff); color:#061021; font-weight:600 }
    .secondary { background: linear-gradient(135deg, var(--accent-2), #8ef5da); color:#061021; font-weight:600 }
    .danger { background: linear-gradient(135deg, #ff8b8b, var(--danger)); color:#2d0b0b; font-weight:700 }
    .ghost { background:#1a2742 }

    .laps {
      max-height: 360px; overflow:auto;
      border-radius:calc(var(--radius) - 6px);
      border:1px solid rgba(255,255,255,.06);
    }
    .laps table { width:100%; border-collapse:collapse; font-variant-numeric: tabular-nums }
    .laps th, .laps td { padding:10px 12px; text-align:right; border-bottom:1px solid rgba(255,255,255,.06) }
    .laps th { position:sticky; top:0; background: var(--panel); font-weight:600 }
    .laps td:first-child, .laps th:first-child { text-align:left }
    .empty { color:var(--muted); text-align:center; padding:18px }

    .footer { display:flex; justify-content:space-between; margin-top:8px; color:var(--muted); font-size:13px }
    .kbd { border:1px solid rgba(255,255,255,.2); border-bottom-width:2px; padding:.5px 6px; border-radius:6px; margin:0 2px; }
  </style>
</head>
<body>
  <main class="app card">
    <header>
      <h1>‚è±Ô∏è Stopwatch</h1>
      <button id="theme-toggle" class="theme-toggle" title="Toggle theme">üåô</button>
    </header>

    <section class="timer">
      <div class="time" id="time-main">00:00:00</div>
      <div class="millis" id="time-ms">00</div>
    </section>

    <div class="controls">
      <button id="btn-start" class="primary">Start</button>
      <button id="btn-lap" class="secondary" disabled>Lap</button>
      <button id="btn-reset" class="ghost" disabled>Reset</button>
      <button id="btn-export" class="ghost" disabled>Export CSV</button>
      <button id="btn-clear" class="danger" disabled>Clear Laps</button>
    </div>

    <section class="laps">
      <table id="laps-table">
        <thead>
          <tr><th>#</th><th>Lap</th><th>Total</th></tr>
        </thead>
        <tbody id="laps-body">
          <tr><td colspan="3" class="empty">No laps yet.</td></tr>
        </tbody>
      </table>
    </section>

    <div class="footer">
      <div>Made with HTML ¬∑ CSS ¬∑ JS</div>
      <div id="status"></div>
    </div>
  </main>

  <script>
    const el = {
      main: document.getElementById('time-main'),
      ms: document.getElementById('time-ms'),
      start: document.getElementById('btn-start'),
      lap: document.getElementById('btn-lap'),
      reset: document.getElementById('btn-reset'),
      export: document.getElementById('btn-export'),
      clear: document.getElementById('btn-clear'),
      lapsBody: document.getElementById('laps-body'),
      themeToggle: document.getElementById('theme-toggle'),
      status: document.getElementById('status')
    };

    let running = false, startTime=0, accumulated=0, laps=[], rafId=null;

    function fmt(ms){
      const h = Math.floor(ms/3600000);
      const m = Math.floor((ms%3600000)/60000);
      const s = Math.floor((ms%60000)/1000);
      const cs= Math.floor((ms%1000)/10);
      return {
        HH:String(h).padStart(2,'0'),
        MM:String(m).padStart(2,'0'),
        SS:String(s).padStart(2,'0'),
        CS:String(cs).padStart(2,'0')
      }
    }
    function render(ms){
      const {HH,MM,SS,CS}=fmt(ms);
      el.main.textContent=`${HH}:${MM}:${SS}`;
      el.ms.textContent=CS;
      document.title = running ? `‚è±Ô∏è Running... ${HH}:${MM}:${SS}` : "Stopwatch";
    }
    function now(){return performance.now();}
    function tick(){
      const elapsed=accumulated+(running?(now()-startTime):0);
      render(elapsed);
      rafId=requestAnimationFrame(tick);
      saveState();
    }
    function start(){
      if(running)return;
      running=true; startTime=now();
      el.start.textContent="Pause";
      el.lap.disabled=false; el.reset.disabled=false;
    }
    function pause(){
      if(!running)return;
      running=false; accumulated+=now()-startTime;
      el.start.textContent="Start";
    }
    function reset(){
      pause(); accumulated=0; laps=[];
      render(0); drawLaps();
      el.reset.disabled=true; el.lap.disabled=true; 
      el.export.disabled=true; el.clear.disabled=true;
    }
    function currentTotal(){ return accumulated+(running?(now()-startTime):0); }
    function addLap(){
      const total=currentTotal();
      const prev=laps.length?laps[laps.length-1].totalMs:0;
      laps.push({lapMs:total-prev,totalMs:total});
      drawLaps();
    }
    function drawLaps(){
      const tbody=el.lapsBody; tbody.innerHTML="";
      if(!laps.length){
        tbody.innerHTML='<tr><td colspan="3" class="empty">No laps yet.</td></tr>'; 
        el.export.disabled=true; el.clear.disabled=true;
        return;
      }
      laps.forEach((l,i)=>{
        const tr=document.createElement("tr");
        tr.innerHTML=`<td>${i+1}</td><td>${toDisp(l.lapMs)}</td><td>${toDisp(l.totalMs)}</td>`;
        tbody.appendChild(tr);
      });
      el.export.disabled=false; 
      el.clear.disabled=false;
    }
    function toDisp(ms){ const {HH,MM,SS,CS}=fmt(ms); return `${HH}:${MM}:${SS}.${CS}`; }
    function exportCSV(){
      if(!laps.length)return;
      const header="Lap #,Lap Time,Total Time\n";
      const rows=laps.map((l,i)=>`${i+1},${toDisp(l.lapMs)},${toDisp(l.totalMs)}`).join("\n");
      const blob=new Blob([header+rows],{type:"text/csv"});
      const url=URL.createObjectURL(blob);
      const a=document.createElement("a");
      a.href=url; a.download="laps.csv"; a.click(); URL.revokeObjectURL(url);
    }
    function clearLaps(){ laps=[]; drawLaps(); }

    // --- Theme Toggle ---
    function applyTheme(theme){
      document.body.dataset.theme=theme;
      el.themeToggle.textContent = theme==="light"?"üåô":"‚òÄÔ∏è";
      localStorage.setItem("theme",theme);
    }
    el.themeToggle.addEventListener("click",()=>applyTheme(document.body.dataset.theme==="light"?"dark":"light"));
    applyTheme(localStorage.getItem("theme")||"dark");

    // --- Save / Load state ---
    function saveState(){
      const state={running,accumulated,runningSince:running?Date.now()- (now()-startTime):0,laps};
      localStorage.setItem("stopwatch",JSON.stringify(state));
    }
    function loadState(){
      const data=localStorage.getItem("stopwatch");
      if(!data)return;
      const state=JSON.parse(data);
      accumulated=state.accumulated;
      laps=state.laps||[];
      if(state.running){running=true; startTime=now(); el.start.textContent="Pause";}
      drawLaps();
    }

    // Wire controls
    el.start.addEventListener("click",()=>running?pause():start());
    el.reset.addEventListener("click",reset);
    el.lap.addEventListener("click",addLap);
    el.export.addEventListener("click",exportCSV);
    el.clear.addEventListener("click",clearLaps);

    loadState();
    rafId=requestAnimationFrame(tick);
  </script>
</body>
</html>


